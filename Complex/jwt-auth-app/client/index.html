<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>JWT Auth Demo</title>
</head>
<body>

<h2>Register</h2>
<input id="ruser" placeholder="Username"><br>
<input id="rpass" placeholder="Password" type="password"><br>
<button onclick="register()">Register</button>
<hr>

<h2>Login</h2>
<input id="luser" placeholder="Username"><br>
<input id="lpass" placeholder="Password" type="password"><br>
<button onclick="login()">Login</button>

<hr>

<h2>Get Profile (Protected)</h2>
<button onclick="getProfile()">Get Profile</button>

<script>
let accessToken = "";
let refreshToken = "";

async function register() {
  const res = await fetch("http://localhost:4000/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: document.getElementById("ruser").value,
      password: document.getElementById("rpass").value,
    }),
  });
  alert(await res.text());
}

async function login() {
  const res = await fetch("http://localhost:4000/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: document.getElementById("luser").value,
      password: document.getElementById("lpass").value,
    }),
  });

  const data = await res.json();
  accessToken = data.accessToken;
  refreshToken = data.refreshToken;

  alert("Login successful!");
}

async function getProfile() {
  const res = await fetch("http://localhost:4000/profile", {
    headers: { Authorization: "Bearer " + accessToken },
  });

  const data = await res.json();
  alert(JSON.stringify(data, null, 2));
}
</script>

</body>
</html>
